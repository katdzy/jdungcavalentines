<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Be My Valentine üíå</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400;1,700&family=Dancing+Script:wght@600;700&family=Lato:wght@300;400&display=swap" rel="stylesheet"/>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --rose:  #e8405a;
      --blush: #f9c4cf;
      --cream: #fff5f7;
      --gold:  #d4a843;
      --deep:  #8b1a2e;
      --text:  #4a1020;
    }

    html, body {
      height: 100%;
      overflow: hidden;
      font-family: 'Lato', sans-serif;
      background: var(--cream);
      color: var(--text);
      cursor: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'%3E%3Ctext y='26' font-size='26'%3E%F0%9F%92%8C%3C/text%3E%3C/svg%3E") 16 16, auto;
    }

    #bg-canvas { position: fixed; inset: 0; z-index: 0; pointer-events: none; }

    /* ‚îÄ‚îÄ CARD ‚îÄ‚îÄ */
    #card {
      position: relative; z-index: 10;
      width: min(520px, 92vw);
      margin: 0 auto;
      top: 50%; transform: translateY(-50%);
      background: #fff;
      border-radius: 28px;
      box-shadow: 0 8px 48px rgba(232,64,90,.18), 0 2px 12px rgba(0,0,0,.07);
      padding: clamp(26px,6vw,56px) clamp(18px,6vw,48px) clamp(26px,5vw,48px);
      text-align: center;
      border: 2.5px solid var(--blush);
      overflow: visible;
    }
    #card::before {
      content: '';
      position: absolute; top:-2px; left:-2px; right:-2px; bottom:-2px;
      border-radius: 30px;
      background: linear-gradient(135deg,#f9c4cf55,#e8405a22,#f9c4cf55);
      z-index: -1; pointer-events: none;
    }

    .ribbon {
      font-size: clamp(1.3rem,4vw,2rem);
      letter-spacing: .4rem;
      margin-bottom: 8px;
      animation: float 3s ease-in-out infinite;
    }
    @keyframes float { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-6px)} }

    h1 {
      font-family: 'Dancing Script', cursive;
      font-size: clamp(1.8rem,5vw,3.2rem);
      color: var(--rose); line-height: 1.2; margin-bottom: 10px;
    }
    .subtitle {
      font-family: 'Playfair Display', serif;
      font-style: italic;
      font-size: clamp(.85rem,2.5vw,1rem);
      color: #b06070;
      margin-bottom: clamp(20px,5vw,42px);
      letter-spacing: .02em;
    }
    .bear {
      font-size: clamp(3.2rem,10vw,5.5rem);
      margin-bottom: clamp(12px,4vw,28px);
      display: block;
      animation: bounce 2s ease-in-out infinite;
    }
    @keyframes bounce { 0%,100%{transform:scale(1) rotate(-4deg)} 50%{transform:scale(1.08) rotate(4deg)} }

    /* ‚îÄ‚îÄ BUTTONS ‚îÄ‚îÄ */
    .btn-row {
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 70px; /* keeps space after No escapes */
    }

    .btn {
      display: inline-flex; align-items: center; justify-content: center; gap: 8px;
      border: none; border-radius: 50px;
      font-family: 'Dancing Script', cursive; font-weight: 700;
      cursor: pointer; white-space: nowrap;
      -webkit-tap-highlight-color: transparent;
    }

    #btn-yes {
      background: linear-gradient(135deg, var(--rose), var(--deep));
      color: #fff;
      font-size: 1.4rem; padding: 14px 36px;
      box-shadow: 0 6px 24px rgba(232,64,90,.4);
      transition: font-size .3s cubic-bezier(.34,1.56,.64,1),
                  padding   .3s cubic-bezier(.34,1.56,.64,1),
                  box-shadow .2s;
      touch-action: manipulation;
    }
    #btn-yes:hover  { box-shadow: 0 10px 36px rgba(232,64,90,.55); transform: scale(1.06); }
    #btn-yes:active { transform: scale(.97); }

    /* No button ‚Äî starts inline, JS switches to position:fixed */
    #btn-no {
      background: #f2e8ea; color: #c07080;
      font-size: 1.1rem; padding: 12px 28px;
      box-shadow: 0 3px 12px rgba(0,0,0,.08);
      margin-left: 20px;
      transition: left .2s cubic-bezier(.34,1.56,.64,1),
                  top  .2s cubic-bezier(.34,1.56,.64,1),
                  font-size .2s, padding .2s, opacity .3s;
      touch-action: none; /* prevents scroll-interference on touch */
      user-select: none; -webkit-user-select: none;
    }
    #btn-no:hover { background: #eddde0; }

    /* ‚îÄ‚îÄ CELEBRATION ‚îÄ‚îÄ */
    #celebration {
      display: none; position: fixed; inset: 0; z-index: 200;
      flex-direction: column; align-items: center; justify-content: center;
      background: radial-gradient(ellipse at center,#fff0f3 0%,#ffe4ea 60%,#ffc8d3 100%);
      animation: fadeIn .5s ease;
      padding: 20px; text-align: center;
    }
    #celebration.show { display: flex; }
    @keyframes fadeIn { from{opacity:0;transform:scale(.94)} to{opacity:1;transform:scale(1)} }

    .cel-emoji {
      font-size: clamp(4rem,12vw,6rem);
      animation: pop .5s cubic-bezier(.34,1.56,.64,1);
    }
    @keyframes pop { 0%{transform:scale(0) rotate(-20deg)} 100%{transform:scale(1) rotate(0)} }

    .cel-title {
      font-family: 'Dancing Script', cursive;
      font-size: clamp(2.2rem,8vw,5rem);
      color: var(--rose); margin: 20px 0 10px;
      animation: slideUp .6s .15s both;
    }
    .cel-sub {
      font-family: 'Playfair Display', serif; font-style: italic;
      font-size: clamp(.95rem,3vw,1.4rem);
      color: var(--deep); max-width: 420px; line-height: 1.7;
      animation: slideUp .6s .3s both;
    }
    @keyframes slideUp { from{opacity:0;transform:translateY(24px)} to{opacity:1;transform:translateY(0)} }

    #confetti-canvas { position:fixed; inset:0; pointer-events:none; z-index:199; }
  </style>
</head>
<body>

<canvas id="bg-canvas"></canvas>

<div id="card">
  <div class="ribbon">üíå üíó üíå</div>
  <span class="bear" id="bear">üêª</span>
  <h1>Will you be my Valentine?</h1>
  <p class="subtitle" id="subtitle">You make my heart go boom üíì</p>
  <div class="btn-row" id="btn-row">
    <button class="btn" id="btn-yes" onclick="sayYes()">Yes! üíò</button>
    <button class="btn" id="btn-no">No üòî</button>
  </div>
</div>

<div id="celebration">
  <canvas id="confetti-canvas"></canvas>
  <div class="cel-emoji">ü•∞</div>
  <h2 class="cel-title">YAY! I knew it! üíï</h2>
  <p class="cel-sub">You've made me the happiest bear in the whole wide world.<br>Happy Valentine's Day, my love! üåπ‚ú®</p>
</div>

<script>
/* ‚îÄ‚îÄ‚îÄ FLOATING HEARTS BACKGROUND ‚îÄ‚îÄ‚îÄ */
(function(){
  const canvas = document.getElementById('bg-canvas');
  const ctx = canvas.getContext('2d');
  const HEARTS = 'üíóüíìüíñüíùüíò';
  let W, H;
  const particles = [];
  function resize(){ W = canvas.width = innerWidth; H = canvas.height = innerHeight; }
  resize(); window.addEventListener('resize', resize);
  const r = (a,b) => Math.random()*(b-a)+a;
  for(let i=0;i<26;i++) particles.push({
    x:r(0,1), y:r(0,1), size:r(16,36), speed:r(.0003,.0009),
    sway:r(.0002,.0005), phase:r(0,Math.PI*2),
    emoji:HEARTS[Math.floor(r(0,HEARTS.length))], opacity:r(.2,.55)
  });
  (function draw(){
    ctx.clearRect(0,0,W,H);
    const t = performance.now();
    for(const p of particles){
      p.y -= p.speed;
      if(p.y<-.08){ p.y=1.05; p.x=r(0,1); }
      ctx.globalAlpha = p.opacity;
      ctx.font = p.size+'px serif';
      ctx.fillText(p.emoji, p.x*W + Math.sin(t*p.sway+p.phase)*28, p.y*H);
    }
    ctx.globalAlpha=1;
    requestAnimationFrame(draw);
  })();
})();


/* ‚îÄ‚îÄ‚îÄ NO BUTTON LOGIC ‚îÄ‚îÄ‚îÄ */
const noBtn  = document.getElementById('btn-no');
const yesBtn = document.getElementById('btn-yes');

let yesLevel  = 0;
let noIsFixed = false;

const noMessages = ["No üòî","Are you sure? ü•∫","Please?? üôè","WAIT‚Äî üò±","Come back! üí®","‚Ä¶nope üí®"];
const bearMoods  = ['üêª','ü•∫','üò¢','üò≠','üôà','üôà'];
const subtitles  = [
  "You make my heart go boom üíì",
  "Think carefully‚Ä¶ ü•∫",
  "I have chocolates for you! üç™",
  "I'll be your best friend! üå∏",
  "Last chance‚Ä¶ pleasss üíî",
  "Fine‚Ä¶ no cookies for you üò§"
];

function teleportNo(){
  const btnW = noBtn.offsetWidth  || 90;
  const btnH = noBtn.offsetHeight || 44;
  const pad  = 18;
  const maxX = window.innerWidth  - btnW - pad;
  const maxY = window.innerHeight - btnH - pad;
  const yRect = yesBtn.getBoundingClientRect();

  let nx, ny, tries = 0;
  do {
    nx = pad + Math.floor(Math.random() * Math.max(maxX - pad, 10));
    ny = pad + Math.floor(Math.random() * Math.max(maxY - pad, 10));
    tries++;
    // avoid landing on top of the Yes button
  } while(
    tries < 20 &&
    nx < yRect.right  + 24 && nx + btnW > yRect.left   - 24 &&
    ny < yRect.bottom + 24 && ny + btnH > yRect.top    - 24
  );

  noBtn.style.left = nx + 'px';
  noBtn.style.top  = ny + 'px';
}

function runAway(e){
  // KEY FIX: preventDefault on touchstart prevents the tap from
  // being treated as a click, so the button can never be "tapped" directly.
  if(e && e.cancelable) e.preventDefault();

  yesLevel = Math.min(yesLevel + 1, 6);

  // On first escape: snapshot position and switch to fixed
  if(!noIsFixed){
    const rect = noBtn.getBoundingClientRect();
    noBtn.style.position = 'fixed';
    noBtn.style.margin   = '0';
    noBtn.style.left = rect.left + 'px';
    noBtn.style.top  = rect.top  + 'px';
    noIsFixed = true;
    // One rAF so browser registers the "from" position before animating away
    requestAnimationFrame(teleportNo);
  } else {
    teleportNo();
  }

  // Grow Yes button
  const sz = 1.4 + yesLevel * 0.55;
  const py = 14  + yesLevel * 6;
  const px = 36  + yesLevel * 10;
  yesBtn.style.fontSize = sz + 'rem';
  yesBtn.style.padding  = py + 'px ' + px + 'px';

  // Update moods
  const idx = Math.min(yesLevel - 1, noMessages.length - 1);
  noBtn.textContent = noMessages[idx];
  document.getElementById('bear').textContent     = bearMoods[idx];
  document.getElementById('subtitle').textContent = subtitles[idx];

  if(yesLevel >= 5){
    noBtn.style.fontSize = '.75rem';
    noBtn.style.padding  = '8px 14px';
    noBtn.style.opacity  = '0.4';
  }
}

// Desktop: escape on hover
noBtn.addEventListener('mouseover', () => runAway());

// Mobile: intercept touchstart BEFORE the tap fires
// { passive: false } is required to allow e.preventDefault()
noBtn.addEventListener('touchstart', function(e){
  e.preventDefault(); // stops the "click" from ever firing at the new position
  runAway(e);
}, { passive: false });


/* ‚îÄ‚îÄ‚îÄ YES! ‚îÄ‚îÄ‚îÄ */
function sayYes(){
  document.getElementById('celebration').classList.add('show');
  launchConfetti();
}


/* ‚îÄ‚îÄ‚îÄ CONFETTI ‚îÄ‚îÄ‚îÄ */
function launchConfetti(){
  const canvas = document.getElementById('confetti-canvas');
  const ctx    = canvas.getContext('2d');
  canvas.width = innerWidth; canvas.height = innerHeight;

  const COLORS = ['#e8405a','#f9c4cf','#d4a843','#ff6b8a','#ffb3c1','#fff0f3','#c0392b'];
  const SHAPES = ['rect','circle','heart'];
  const pieces = [];

  for(let i=0;i<200;i++) pieces.push({
    x: Math.random()*canvas.width,
    y: Math.random()*-canvas.height*1.2,
    w: Math.random()*13+5, h: Math.random()*8+4,
    color: COLORS[Math.floor(Math.random()*COLORS.length)],
    shape: SHAPES[Math.floor(Math.random()*SHAPES.length)],
    spin:  Math.random()*6-3, angle: Math.random()*Math.PI*2,
    vx: Math.random()*3-1.5, vy: Math.random()*2.5+1.5, alpha: 1
  });

  function drawHeart(c,x,y,s){
    c.beginPath(); c.moveTo(x,y+s/4);
    c.quadraticCurveTo(x,y,x+s/4,y); c.quadraticCurveTo(x+s/2,y,x+s/2,y+s/4);
    c.quadraticCurveTo(x+s/2,y,x+s*3/4,y); c.quadraticCurveTo(x+s,y,x+s,y+s/4);
    c.quadraticCurveTo(x+s,y+s*.6,x+s/2,y+s*.9);
    c.quadraticCurveTo(x,y+s*.6,x,y+s/4); c.closePath(); c.fill();
  }

  let frame = 0;
  (function tick(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    frame++; let alive = false;
    for(const p of pieces){
      p.y+=p.vy; p.x+=p.vx; p.angle+=p.spin*.04;
      if(frame>100) p.alpha-=.014;
      if(p.y<canvas.height+20 && p.alpha>0) alive=true;
      ctx.save();
      ctx.globalAlpha=Math.max(0,p.alpha);
      ctx.translate(p.x,p.y); ctx.rotate(p.angle);
      ctx.fillStyle=p.color;
      if(p.shape==='rect')        ctx.fillRect(-p.w/2,-p.h/2,p.w,p.h);
      else if(p.shape==='circle'){ ctx.beginPath(); ctx.arc(0,0,p.w/2,0,Math.PI*2); ctx.fill(); }
      else                        drawHeart(ctx,-p.w/2,-p.w/2,p.w);
      ctx.restore();
    }
    if(alive) requestAnimationFrame(tick);
  })();
}
</script>
</body>
</html>